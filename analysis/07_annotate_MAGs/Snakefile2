import glob
import os
import pandas as pd

mag_df = pd.read_table('extra_mag_table.txt').set_index("mag", drop=False)
MAGS = list(mag_df['mag'])




rule all:
        input:
                expand("extra_ann/{sample}/{sample}.tsv", sample = MAGS),
        output: touch("touch")



rule get_files:        		
        output: "{sample}.fa",
        shell:
                "cp ../05_MAGs/MAGs/bacs/{wildcards.sample}.fa.gz .;"
                "gzip -d {wildcards.sample}.fa.gz"




rule prokka:
        input: "{sample}.fa"   
        output: "extra_ann/{sample}/{sample}.tsv"
        params:
        # dynamically grab the locus tag from the "locustag" column in the samples data frame
                locustag = lambda wildcards: mag_df.loc[wildcards.sample, "locustag"]
        shell:
                "prokka --compliant --centre UoN --outdir extra_ann/{wildcards.sample} --locustag {params.locustag} --prefix {wildcards.sample} {wildcards.sample}.fa  --force"

